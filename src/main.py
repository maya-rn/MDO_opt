## put main optimization function here